{"version":3,"sources":["d3Controls.js","useCustomHover.js","index.js","HoverDescription.js"],"names":["toRadians","angle","Math","PI","d3Controls","fov","near","far","defaultCameraZoom","renderer","camera","size","width","height","getScaleFromZ","z","tan","getZFromScale","scale","threeZoom","zoom","scaleExtent","on","x","y","k","position","set","zoomHandler","event","transform","view","select","domElement","call","initialScale","initialTransform","zoomIdentity","translate","THREE","require","backgroundColor","Color","colors","sprite","TextureLoader","load","getRandomNumber","random","getRandomPoints","positions","Array","fill","forEach","push","getRandomColors","parseInt","length","r","g","b","Scene","points","pointsData","setHoverData","useThree","scene","aspect","gl","mouse","ref","useRef","pointsRef","geometryRef","useEffect","highlightRef","highlightPoint","useMemo","point","Float32Array","color","show","onPointHover","onPointOut","checkIntersects","raycaster","Raycaster","params","Points","threshold","setFromCamera","intersects","intersectObject","current","intersect","sort","distanceToRay","project","addScalar","divideScalar","index","useCustomHover","positionsArray","slice","d","i","colorsArray","idxs","attributes","needsUpdate","pointColor","map","toFixed","description","top","left","showLeft","max","hoverWidth","className","style","HoverDescription","nPoints","useSpring","pointsSpring","colorsSpring","setSpring","useFrame","getValue","v","value","background","attach","attachObject","count","array","itemSize","usage","DynamicDrawUsage","transparent","alphaTest","sizeAttenuation","vertexColors","VertexColors","ReactDOM","render","useState","setPoints","setColors","animatePoints","setAnimatePoints","animateColors","setAnimateColors","toogleColorsClass","setToogleColorsClass","tooglePointsClass","setTooglePointsClass","hoverData","keys","href","type","onClick","clearInterval","interval","window","setInterval","toogleColors","tooglePoints","document","getElementById"],"mappings":"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","file":"static/js/main.0f0564bd.chunk.js","sourcesContent":["// From https://observablehq.com/@grantcuster/using-three-js-for-2d-data-visualization\nimport { zoom, event, select, zoomIdentity } from 'd3';\n\nconst toRadians = angle => (angle * (Math.PI/180));\n\nexport const d3Controls = ({ fov, near, far, defaultCameraZoom, renderer, camera, size }) => {\n  const { width, height } = size;\n\n  const zoomHandler = ({ x, y, k }) => {\n    camera.position.set(\n      -(x -  width/2) / k, // x\n       (y - height/2) / k, // y\n       getZFromScale(k)    // z\n    )\n  };\n\n  const getScaleFromZ = z => ( height / (2 * z * Math.tan(toRadians(fov/2))) );\n  const getZFromScale = scale => ( height / scale / (2 * Math.tan(toRadians(fov/2))) );\n\n  const threeZoom = zoom()\n    .scaleExtent([getScaleFromZ(far), getScaleFromZ(near)])\n    .on('zoom', () => {\n      zoomHandler(event.transform);\n    });\n  \n  // Add zoom listener\n  const view = select(renderer.domElement);\n  view.call(threeZoom);\n  const initialScale = getScaleFromZ(defaultCameraZoom);\n  const initialTransform = zoomIdentity\n    .translate(width/2, height/2)\n    .scale(initialScale);    \n  threeZoom.transform(view, initialTransform);\n  camera.position.set(0, 0, defaultCameraZoom);\n\n  // Double click resets camera\n  view.on('dblclick.zoom', () => {\n    threeZoom.transform(view, initialTransform);\n    camera.position.set(0, 0, defaultCameraZoom);\n  });\n};\n","import { useMemo, useEffect } from 'react';\nimport { select } from 'd3';\nconst THREE = require('three');\n\nexport const useCustomHover = ({\n  renderer,\n  mouse,\n  camera,\n  size: { width, height },\n  pointsRef,\n  onPointHover,\n  onPointOut\n  }) => {\n    useEffect(() => {\n      const view = select(renderer.domElement);\n      view.on('mousemove', () => {\n        checkIntersects(mouse);\n      });\n    }, [ renderer, mouse ]);\n    \n    const raycaster = useMemo(() => {\n      const raycaster = new THREE.Raycaster();\n      raycaster.params.Points.threshold = 1;\n      return raycaster;\n    }, []);\n    \n    const checkIntersects = position => {\n      raycaster.setFromCamera(position, camera);\n      let intersects = raycaster.intersectObject(pointsRef.current);\n      if (intersects[0]) {\n        const intersect = intersects.sort(({ distanceToRay }) => distanceToRay)[0];\n        const point = intersect.point;\n        point.project(camera).addScalar(1).divideScalar(2);\n        const x = point.x * width;\n        const y = (1-point.y) * height;\n        onPointHover({ index: intersect.index, x, y });\n      } else {\n        onPointOut();\n      }\n    };\n};\n\n","import 'bootstrap/dist/css/bootstrap.css';\nimport React, { useRef, useMemo, useState, useEffect } from 'react';\nimport ReactDOM from 'react-dom';\nimport { Canvas, useThree, useFrame } from 'react-three-fiber';\nimport { useSpring } from 'react-spring-three';\nimport { HoverDescription } from './HoverDescription';\nimport { d3Controls } from './d3Controls';\nimport { useCustomHover } from './useCustomHover';\nimport './index.css';\nconst THREE = require('three');\n// const d3 = require('d3');\n\n// camera settings\nconst fov = 30;\nconst near = 10;\nconst far = 1000;\nconst defaultCameraZoom = 100;\n// canvas settings\nconst backgroundColor = new THREE.Color(0xefefef)\n// points generation\nconst nPoints = 100;\nconst randomScale = 50;\nconst pointsSize = 25;\nconst highlightPointSize = 40;\nconst colors = ['#ffd700', '#ffb14e', '#fa8775', '#ea5f94', '#cd34b5', '#9d02d7', '#0000ff'];\nconst sprite = new THREE.TextureLoader().load('textures/discNoShadow.png');\n\nconst getRandomNumber = () => (Math.random()-0.5)*randomScale;\n\nconst getRandomPoints = () => {\n  let positions = []\n  Array(nPoints).fill().forEach(() => {\n    positions.push(getRandomNumber(), getRandomNumber(), 0);\n  });\n  return positions;\n};\n\nconst getRandomColor = () => new THREE.Color(colors[parseInt(Math.random() * colors.length)]);\nconst getRandomColors = () => {\n  let colors = []\n  Array(nPoints).fill().forEach(() => {\n    const {r,g,b} = getRandomColor();\n    colors.push(r,g,b);\n  });\n  return colors;\n};\n\nconst Scene = ({ points, colors, pointsData, setHoverData }) => {\n  const { scene, aspect, gl, camera, size, mouse } = useThree();\n  const ref = useRef();\n  const pointsRef = useRef();\n  const geometryRef = useRef();\n\n  // d3 controls (zoom and pan)\n  useEffect(() => {\n    d3Controls({ fov, near, far, defaultCameraZoom, renderer: gl, camera, size});\n  }, [ gl, camera, size ])\n\n  // Custom hover\n  const highlightRef = useRef();\n  const highlightPoint = useMemo(() => ({\n    point: new Float32Array(3),\n    color: new Float32Array(3),\n    show: false,\n  }), []);\n\n  const onPointHover = ( { index, x, y } ) => {\n    // Highlight Point\n    positionsArray.slice(index*3,(index+1)*3).forEach( (d, i) => {highlightPoint.point[i] = d});\n    colorsArray.slice(index*3,(index+1)*3).forEach( (d, i) => {highlightPoint.color[i] = d});\n    highlightPoint.show = true;\n    const { idxs } = pointsData;\n    highlightRef.current.attributes.position.needsUpdate = true;\n    highlightRef.current.attributes.color.needsUpdate = true;\n\n    // hover description\n    const pointColor = colors.slice(index*3, (index+1)*3).map(d => d.toFixed(2));\n    setHoverData(HoverDescription({\n      description: `mouse over: ${idxs[index]}\\nColor: rgb(${pointColor})`,\n      top: y,\n      left: x,\n    }));\n  };\n\n  const onPointOut = () => {\n    highlightPoint.show = false;\n    setHoverData('');\n  };\n\n  useCustomHover({ renderer: gl, mouse, camera, size, pointsRef, onPointHover, onPointOut });\n\n  // Initialize arrays\n  const positionsArray = useMemo(() => new Float32Array(nPoints*3), []);\n  const colorsArray = useMemo(() => new Float32Array(nPoints*3), []);\n\n  // Initialize springs\n  const [ { pointsSpring, colorsSpring }, setSpring ] = useSpring(() => ({\n    // initial position\n    pointsSpring: points,\n    colorsSpring: Array(nPoints*3).fill(1),\n  }));\n\n  // Animation effects\n  useEffect(() => {\n    setSpring({ pointsSpring: points });\n  }, [ points, setSpring ]);\n\n  useEffect(() => {\n    setSpring({ colorsSpring: colors });\n  }, [ colors, setSpring ]);\n\n  // Animate point change\n  useFrame(() => {\n    pointsSpring.getValue().forEach((v,i) => {\n      const value = (i%3) === 0 ? v*aspect : v; // consider aspect\n      positionsArray[i] = value;\n    });\n    colorsSpring.getValue().forEach((v,i) => {\n      colorsArray[i] = v;\n    })\n    geometryRef.current.attributes.position.needsUpdate = true;\n    geometryRef.current.attributes.color.needsUpdate = true;\n  });\n\n  useEffect(() => {\n    scene.background = backgroundColor;\n  }, [ scene ]);\n\n  return (\n    <group>\n\n      <mesh ref={ref}>\n        <points ref={pointsRef}>\n          <bufferGeometry\n            attach='geometry'\n            ref={geometryRef}\n          >\n            <bufferAttribute\n              attachObject={['attributes', 'position']}\n              count={points.length / 3}\n              array={positionsArray}\n              itemSize={3}\n              usage={THREE.DynamicDrawUsage}\n            />\n            <bufferAttribute\n              attachObject={['attributes', 'color']}\n              count={points.length / 3}\n              array={colorsArray}\n              itemSize={3}\n              usage={THREE.DynamicDrawUsage}\n            />\n          </bufferGeometry>\n          <pointsMaterial\n            attach='material'\n            size={pointsSize}\n            map={sprite}\n            transparent={true}\n            alphaTest={0.5}\n            sizeAttenuation={false}\n            vertexColors={THREE.VertexColors}\n          />\n        </points>\n      </mesh>\n\n      <mesh>\n        <points>\n          <bufferGeometry\n            attach='geometry'\n            ref={highlightRef}\n          >\n            <bufferAttribute\n              attachObject={['attributes', 'position']}\n              count={highlightPoint.show}\n              array={highlightPoint.point}\n              itemSize={3}\n              usage={THREE.DynamicDrawUsage}\n            /> \n            <bufferAttribute\n              attachObject={['attributes', 'color']}\n              count={1}\n              array={highlightPoint.color}\n              itemSize={3}\n              usage={THREE.DynamicDrawUsage}\n            />\n          </bufferGeometry>\n          <pointsMaterial\n            attach='material'\n            size={highlightPointSize}\n            map={sprite}\n            transparent={true}\n            alphaTest={0.5}\n            sizeAttenuation={false}\n            vertexColors={THREE.VertexColors}\n          />\n        </points>\n      </mesh>\n\n    </group>\n\n  );\n};\n\nconst App = () => {\n  const [ points, setPoints ] = useState(getRandomPoints());\n  const [ colors, setColors ] = useState(getRandomColors());\n  const [ animatePoints, setAnimatePoints ] = useState(false);\n  const [ animateColors, setAnimateColors ] = useState(false);\n  const [ toogleColorsClass, setToogleColorsClass ] = useState('light');\n  const [ tooglePointsClass, setTooglePointsClass ] = useState('light');\n  const [ hoverData, setHoverData] = useState('');\n  const pointsData = useMemo(() => ({\n    idxs: [...Array(nPoints).keys()].map(d => `Points #${d}`),\n  }), []);\n\n  // toogle functions\n  const tooglePoints = () => {\n    if ( !animatePoints ) {\n      const interval = window.setInterval(() => setPoints(getRandomPoints()), 1000);\n      setAnimatePoints(interval);\n      setTooglePointsClass('dark');\n    } else {\n      clearInterval(animatePoints);\n      setAnimatePoints(false);\n      setTooglePointsClass('light');\n    }\n  };\n\n  const toogleColors = () => {\n    if ( !animateColors ) {\n      const interval = window.setInterval(() => setColors(getRandomColors()), 1000);\n      setAnimateColors(interval);\n      setToogleColorsClass('dark');\n    } else {\n      clearInterval(animateColors);\n      setAnimateColors(false);\n      setToogleColorsClass('light');\n    }\n  };\n\n  return (\n    <div className='canvas-container'>\n      <Canvas\n        camera={{\n          fov: fov,\n          near: near,\n          far: far,\n          position: [0, 0, defaultCameraZoom]\n        }}\n      >\n        <Scene\n          points={points}\n          colors={colors}\n          pointsData={pointsData}\n          setHoverData={setHoverData}\n        />\n      </Canvas>\n      {hoverData}\n      <div className='git-info'>\n        <a href='https://github.com/renato145/threejs_test'>Source code</a>\n      </div>\n      <div className='button-container'>\n        <button\n          type='button'\n          className='btn btn-light'\n          onClick={() => setColors(getRandomColors())}\n        >\n          Change colors\n        </button>\n        <button\n          type='button'\n          className={`btn btn-${toogleColorsClass}`}\n          onClick={() => toogleColors()}\n        >\n          Toogle colors\n        </button>\n        <button\n          type='button'\n          className='btn btn-light'\n          onClick={() => setPoints(getRandomPoints())}\n        >\n          Refresh\n        </button>\n        <button\n          type='button'\n          className={`btn btn-${tooglePointsClass}`}\n          onClick={() => tooglePoints()}\n        >\n          Toogle Refresh\n        </button>\n      </div>\n    </div>\n  )\n};\n\nReactDOM.render(<App />, document.getElementById('root'));\n","import React from 'react';\n\nconst hoverWidth = 150;\n\nexport const HoverDescription = ({ description, top, left }) => {\n  const showLeft = Math.max(left-hoverWidth/2, 0);\n  return (\n  <div\n    className='hover-description'\n    style={{top: top, left: showLeft, width: hoverWidth}}\n  >\n    {description}\n  </div>);\n};\n"],"sourceRoot":""}