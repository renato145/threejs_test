(this.webpackJsonpthreejs_tests=this.webpackJsonpthreejs_tests||[]).push([[0],{46:function(e,t,n){e.exports=n(55)},51:function(e,t,n){},55:function(e,t,n){"use strict";n.r(t);var a=n(4),r=n(2),o=(n(47),n(0)),c=n.n(o),i=n(15),s=n.n(i),u=n(13),l=n(36),f=n(11),m=function(e){return e*(Math.PI/180)},b=function(e){var t=e.fov,n=e.near,a=e.far,r=e.defaultCameraZoom,o=e.renderer,c=e.camera,i=e.size,s=i.width,u=i.height,l=function(e){return u/(2*e*Math.tan(m(t/2)))},b=function(e){return u/e/(2*Math.tan(m(t/2)))},p=Object(f.c)().scaleExtent([l(a),l(n)]).on("zoom",(function(){!function(e){var t=e.x,n=e.y,a=e.k;c.position.set(-(t-s/2)/a,(n-u/2)/a,b(a))}(f.a.transform)})),h=Object(f.b)(o.domElement);h.call(p);var d=l(r),j=f.d.translate(s/2,u/2).scale(d);p.transform(h,j),c.position.set(0,0,r),h.on("dblclick.zoom",(function(){p.transform(h,j),c.position.set(0,0,r)}))},p=n(3),h=(n(51),n(3)),d=new h.Color(15724527),j=["#ffd700","#ffb14e","#fa8775","#ea5f94","#cd34b5","#9d02d7","#0000ff"],v=(new h.TextureLoader).load("textures/discNoShadow.png"),O=function(){return 50*(Math.random()-.5)},g=function(){var e=[];return Array(100).fill().forEach((function(){e.push(O(),O(),0)})),e},E=function(){var e=[];return Array(100).fill().forEach((function(){var t=new h.Color(j[parseInt(Math.random()*j.length)]),n=t.r,a=t.g,r=t.b;e.push(n,a,r)})),e},y=function(e){var t=e.points,n=e.colors,a=e.pointsData,i=e.setHoverData,s=Object(u.d)(),m=s.scene,j=s.aspect,O=s.gl,g=s.camera,E=s.size,y=s.mouse,w=Object(o.useRef)(),S=Object(o.useRef)(),x=Object(o.useRef)();Object(o.useEffect)((function(){b({fov:30,near:20,far:150,defaultCameraZoom:100,renderer:O,camera:g,size:E})}),[O,g,E]);var z=Object(o.useRef)(),C=Object(o.useMemo)((function(){return{point:new Float32Array(3),color:new Float32Array(3),show:!1}}),[]),k=Object(o.useCallback)((function(e){var t=e.index,r=e.x,o=e.y;A.slice(3*t,3*(t+1)).forEach((function(e,t){C.point[t]=e})),M.slice(3*t,3*(t+1)).forEach((function(e,t){C.color[t]=e})),C.show=!0;var s=a.idxs;z.current.attributes.position.needsUpdate=!0,z.current.attributes.color.needsUpdate=!0;var u=n.slice(3*t,3*(t+1)).map((function(e){return e.toFixed(2)}));i(function(e){var t=e.description,n=e.top,a=e.left,r=e.size,o=a+150>r.width?r.right-150:Math.max(a-75,r.left);return c.a.createElement("div",{className:"hover-description",style:{top:n,left:o,width:150}},t)}({description:"mouse over: ".concat(s[t],"\nColor: rgb(").concat(u,")"),top:o,left:r,size:E}))}),[t,E]);!function(e){var t=e.renderer,n=e.mouse,a=e.camera,r=e.size,c=e.pointsRef,i=e.onPointHover,s=e.onPointOut,u=Object(o.useMemo)((function(){var e=new p.Raycaster;return e.params.Points.threshold=1,e}),[]),l=Object(o.useCallback)((function(e){u.setFromCamera(e,a);var t=u.intersectObject(c.current);if(t[0]){var n=t.sort((function(e){return e.distanceToRay}))[0],o=n.point;o.project(a).addScalar(1).divideScalar(2);var l=o.x*r.width,f=(1-o.y)*r.height;i({index:n.index,x:l,y:f})}else s()}),[r,i]);Object(o.useEffect)((function(){Object(f.b)(t.domElement).on("mousemove",(function(){l(n)}))}),[t,n,l])}({renderer:O,mouse:y,camera:g,size:E,pointsRef:S,onPointHover:k,onPointOut:function(){C.show=!1,i("")}});var A=Object(o.useMemo)((function(){return new Float32Array(300)}),[]),M=Object(o.useMemo)((function(){return new Float32Array(300)}),[]),D=Object(l.a)((function(){return{pointsSpring:t,colorsSpring:Array(300).fill(1)}})),N=Object(r.a)(D,2),R=N[0],U=R.pointsSpring,I=R.colorsSpring,P=N[1];return Object(o.useEffect)((function(){P({pointsSpring:t})}),[t,P]),Object(o.useEffect)((function(){P({colorsSpring:n})}),[n,P]),Object(u.c)((function(){U.getValue().forEach((function(e,t){var n=t%3===0?e*j:e;A[t]=n})),I.getValue().forEach((function(e,t){M[t]=e})),x.current.attributes.position.needsUpdate=!0,x.current.attributes.color.needsUpdate=!0})),Object(o.useEffect)((function(){m.background=d}),[m]),c.a.createElement("group",null,c.a.createElement("mesh",{ref:w},c.a.createElement("points",{ref:S},c.a.createElement("bufferGeometry",{attach:"geometry",ref:x},c.a.createElement("bufferAttribute",{attachObject:["attributes","position"],count:t.length/3,array:A,itemSize:3,usage:h.DynamicDrawUsage}),c.a.createElement("bufferAttribute",{attachObject:["attributes","color"],count:t.length/3,array:M,itemSize:3,usage:h.DynamicDrawUsage})),c.a.createElement("pointsMaterial",{attach:"material",size:15,map:v,transparent:!0,alphaTest:.5,sizeAttenuation:!1,vertexColors:h.VertexColors}))),c.a.createElement("mesh",null,c.a.createElement("points",null,c.a.createElement("bufferGeometry",{attach:"geometry",ref:z},c.a.createElement("bufferAttribute",{attachObject:["attributes","position"],count:C.show,array:C.point,itemSize:3,usage:h.DynamicDrawUsage}),c.a.createElement("bufferAttribute",{attachObject:["attributes","color"],count:1,array:C.color,itemSize:3,usage:h.DynamicDrawUsage})),c.a.createElement("pointsMaterial",{attach:"material",size:40,map:v,transparent:!0,alphaTest:.5,sizeAttenuation:!1,vertexColors:h.VertexColors}))))};s.a.render(c.a.createElement((function(){var e=Object(o.useState)(g()),t=Object(r.a)(e,2),n=t[0],i=t[1],s=Object(o.useState)(E()),l=Object(r.a)(s,2),f=l[0],m=l[1],b=Object(o.useState)(!1),p=Object(r.a)(b,2),h=p[0],d=p[1],j=Object(o.useState)(!1),v=Object(r.a)(j,2),O=v[0],w=v[1],S=Object(o.useState)("light"),x=Object(r.a)(S,2),z=x[0],C=x[1],k=Object(o.useState)("light"),A=Object(r.a)(k,2),M=A[0],D=A[1],N=Object(o.useState)(""),R=Object(r.a)(N,2),U=R[0],I=R[1],P=Object(o.useMemo)((function(){return{idxs:Object(a.a)(Array(100).keys()).map((function(e){return"Points #".concat(e)}))}}),[]);return c.a.createElement("div",{style:{height:"100%"}},c.a.createElement("div",{className:"canvas-container h-100"},c.a.createElement(u.a,{camera:{fov:30,near:.1,far:151,position:[0,0,100]}},c.a.createElement(y,{points:n,colors:f,pointsData:P,setHoverData:I})),U,c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"git-info col"},c.a.createElement("a",{href:"https://github.com/renato145/threejs_test"},"Source code")),c.a.createElement("div",{className:"button-container col"},c.a.createElement("button",{type:"button",className:"btn btn-light",onClick:function(){return m(E())}},"Change colors"),c.a.createElement("button",{type:"button",className:"btn btn-".concat(z),onClick:function(){return function(){if(O)clearInterval(O),w(!1),C("light");else{var e=window.setInterval((function(){return m(E())}),1e3);w(e),C("dark")}}()}},"Toogle colors"),c.a.createElement("button",{type:"button",className:"btn btn-light",onClick:function(){return i(g())}},"Refresh"),c.a.createElement("button",{type:"button",className:"btn btn-".concat(M),onClick:function(){return function(){if(h)clearInterval(h),d(!1),D("light");else{var e=window.setInterval((function(){return i(g())}),1e3);d(e),D("dark")}}()}},"Toogle Refresh")))))}),null),document.getElementById("root"))}},[[46,1,2]]]);
//# sourceMappingURL=main.19f17342.chunk.js.map