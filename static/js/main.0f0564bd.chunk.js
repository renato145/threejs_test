(this.webpackJsonpthreejs_tests=this.webpackJsonpthreejs_tests||[]).push([[0],{46:function(e,t,n){e.exports=n(55)},51:function(e,t,n){},55:function(e,t,n){"use strict";n.r(t);var a=n(4),r=n(2),o=(n(47),n(0)),c=n.n(o),i=n(15),s=n.n(i),u=n(13),l=n(36),f=n(11),m=function(e){return e*(Math.PI/180)},b=function(e){var t=e.fov,n=e.near,a=e.far,r=e.defaultCameraZoom,o=e.renderer,c=e.camera,i=e.size,s=i.width,u=i.height,l=function(e){return u/(2*e*Math.tan(m(t/2)))},b=function(e){return u/e/(2*Math.tan(m(t/2)))},p=Object(f.c)().scaleExtent([l(a),l(n)]).on("zoom",(function(){!function(e){var t=e.x,n=e.y,a=e.k;c.position.set(-(t-s/2)/a,(n-u/2)/a,b(a))}(f.a.transform)})),h=Object(f.b)(o.domElement);h.call(p);var d=l(r),v=f.d.translate(s/2,u/2).scale(d);p.transform(h,v),c.position.set(0,0,r),h.on("dblclick.zoom",(function(){p.transform(h,v),c.position.set(0,0,r)}))},p=n(3),h=(n(51),n(3)),d=new h.Color(15724527),v=["#ffd700","#ffb14e","#fa8775","#ea5f94","#cd34b5","#9d02d7","#0000ff"],j=(new h.TextureLoader).load("textures/discNoShadow.png"),O=function(){return 50*(Math.random()-.5)},g=function(){var e=[];return Array(100).fill().forEach((function(){e.push(O(),O(),0)})),e},E=function(){var e=[];return Array(100).fill().forEach((function(){var t=new h.Color(v[parseInt(Math.random()*v.length)]),n=t.r,a=t.g,r=t.b;e.push(n,a,r)})),e},y=function(e){var t=e.points,n=e.colors,a=e.pointsData,i=e.setHoverData,s=Object(u.d)(),m=s.scene,v=s.aspect,O=s.gl,g=s.camera,E=s.size,y=s.mouse,w=Object(o.useRef)(),S=Object(o.useRef)(),x=Object(o.useRef)();Object(o.useEffect)((function(){b({fov:30,near:10,far:1e3,defaultCameraZoom:100,renderer:O,camera:g,size:E})}),[O,g,E]);var z=Object(o.useRef)(),C=Object(o.useMemo)((function(){return{point:new Float32Array(3),color:new Float32Array(3),show:!1}}),[]);!function(e){var t=e.renderer,n=e.mouse,a=e.camera,r=e.size,c=r.width,i=r.height,s=e.pointsRef,u=e.onPointHover,l=e.onPointOut;Object(o.useEffect)((function(){Object(f.b)(t.domElement).on("mousemove",(function(){b(n)}))}),[t,n]);var m=Object(o.useMemo)((function(){var e=new p.Raycaster;return e.params.Points.threshold=1,e}),[]),b=function(e){m.setFromCamera(e,a);var t=m.intersectObject(s.current);if(t[0]){var n=t.sort((function(e){return e.distanceToRay}))[0],r=n.point;r.project(a).addScalar(1).divideScalar(2);var o=r.x*c,f=(1-r.y)*i;u({index:n.index,x:o,y:f})}else l()}}({renderer:O,mouse:y,camera:g,size:E,pointsRef:S,onPointHover:function(e){var t=e.index,r=e.x,o=e.y;A.slice(3*t,3*(t+1)).forEach((function(e,t){C.point[t]=e})),M.slice(3*t,3*(t+1)).forEach((function(e,t){C.color[t]=e})),C.show=!0;var s=a.idxs;z.current.attributes.position.needsUpdate=!0,z.current.attributes.color.needsUpdate=!0;var u=n.slice(3*t,3*(t+1)).map((function(e){return e.toFixed(2)}));i(function(e){var t=e.description,n=e.top,a=e.left,r=Math.max(a-75,0);return c.a.createElement("div",{className:"hover-description",style:{top:n,left:r,width:150}},t)}({description:"mouse over: ".concat(s[t],"\nColor: rgb(").concat(u,")"),top:o,left:r}))},onPointOut:function(){C.show=!1,i("")}});var A=Object(o.useMemo)((function(){return new Float32Array(300)}),[]),M=Object(o.useMemo)((function(){return new Float32Array(300)}),[]),k=Object(l.a)((function(){return{pointsSpring:t,colorsSpring:Array(300).fill(1)}})),D=Object(r.a)(k,2),R=D[0],N=R.pointsSpring,U=R.colorsSpring,I=D[1];return Object(o.useEffect)((function(){I({pointsSpring:t})}),[t,I]),Object(o.useEffect)((function(){I({colorsSpring:n})}),[n,I]),Object(u.c)((function(){N.getValue().forEach((function(e,t){var n=t%3===0?e*v:e;A[t]=n})),U.getValue().forEach((function(e,t){M[t]=e})),x.current.attributes.position.needsUpdate=!0,x.current.attributes.color.needsUpdate=!0})),Object(o.useEffect)((function(){m.background=d}),[m]),c.a.createElement("group",null,c.a.createElement("mesh",{ref:w},c.a.createElement("points",{ref:S},c.a.createElement("bufferGeometry",{attach:"geometry",ref:x},c.a.createElement("bufferAttribute",{attachObject:["attributes","position"],count:t.length/3,array:A,itemSize:3,usage:h.DynamicDrawUsage}),c.a.createElement("bufferAttribute",{attachObject:["attributes","color"],count:t.length/3,array:M,itemSize:3,usage:h.DynamicDrawUsage})),c.a.createElement("pointsMaterial",{attach:"material",size:25,map:j,transparent:!0,alphaTest:.5,sizeAttenuation:!1,vertexColors:h.VertexColors}))),c.a.createElement("mesh",null,c.a.createElement("points",null,c.a.createElement("bufferGeometry",{attach:"geometry",ref:z},c.a.createElement("bufferAttribute",{attachObject:["attributes","position"],count:C.show,array:C.point,itemSize:3,usage:h.DynamicDrawUsage}),c.a.createElement("bufferAttribute",{attachObject:["attributes","color"],count:1,array:C.color,itemSize:3,usage:h.DynamicDrawUsage})),c.a.createElement("pointsMaterial",{attach:"material",size:40,map:j,transparent:!0,alphaTest:.5,sizeAttenuation:!1,vertexColors:h.VertexColors}))))};s.a.render(c.a.createElement((function(){var e=Object(o.useState)(g()),t=Object(r.a)(e,2),n=t[0],i=t[1],s=Object(o.useState)(E()),l=Object(r.a)(s,2),f=l[0],m=l[1],b=Object(o.useState)(!1),p=Object(r.a)(b,2),h=p[0],d=p[1],v=Object(o.useState)(!1),j=Object(r.a)(v,2),O=j[0],w=j[1],S=Object(o.useState)("light"),x=Object(r.a)(S,2),z=x[0],C=x[1],A=Object(o.useState)("light"),M=Object(r.a)(A,2),k=M[0],D=M[1],R=Object(o.useState)(""),N=Object(r.a)(R,2),U=N[0],I=N[1],P=Object(o.useMemo)((function(){return{idxs:Object(a.a)(Array(100).keys()).map((function(e){return"Points #".concat(e)}))}}),[]);return c.a.createElement("div",{className:"canvas-container"},c.a.createElement(u.a,{camera:{fov:30,near:10,far:1e3,position:[0,0,100]}},c.a.createElement(y,{points:n,colors:f,pointsData:P,setHoverData:I})),U,c.a.createElement("div",{className:"git-info"},c.a.createElement("a",{href:"https://github.com/renato145/threejs_test"},"Source code")),c.a.createElement("div",{className:"button-container"},c.a.createElement("button",{type:"button",className:"btn btn-light",onClick:function(){return m(E())}},"Change colors"),c.a.createElement("button",{type:"button",className:"btn btn-".concat(z),onClick:function(){return function(){if(O)clearInterval(O),w(!1),C("light");else{var e=window.setInterval((function(){return m(E())}),1e3);w(e),C("dark")}}()}},"Toogle colors"),c.a.createElement("button",{type:"button",className:"btn btn-light",onClick:function(){return i(g())}},"Refresh"),c.a.createElement("button",{type:"button",className:"btn btn-".concat(k),onClick:function(){return function(){if(h)clearInterval(h),d(!1),D("light");else{var e=window.setInterval((function(){return i(g())}),1e3);d(e),D("dark")}}()}},"Toogle Refresh")))}),null),document.getElementById("root"))}},[[46,1,2]]]);
//# sourceMappingURL=main.0f0564bd.chunk.js.map